name: Sync Upstream

permissions:
  contents: write

on:
  schedule:
    - cron: "0 0 * * *" # 每天 UTC 0点 (北京时间 8点) 运行一次
  workflow_dispatch: # 允许手动触发

jobs:
  sync_latest_from_upstream:
    name: Sync latest commits from upstream repo
    runs-on: ubuntu-latest
    if: github.repository != 'Dreamy-rain/gemini-business2api'

    steps:
      - name: Checkout target repo
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # 必须设置为 0 以获取所有历史记录进行同步

      - name: Sync upstream changes
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          # 使用 GitHub CLI 同步上游
          gh repo sync ${{ github.repository }} -b main
